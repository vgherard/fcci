<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Poisson rate confidence intervals — confint_pois • fcci</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Poisson rate confidence intervals — confint_pois"><meta property="og:description" content="Build confidence intervals for the rate of a Poisson random variable using
the Feldman-Cousins construction (Feldman and Cousins, 1998)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fcci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vgherard/fcci/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Poisson rate confidence intervals</h1>
    <small class="dont-index">Source: <a href="https://github.com/vgherard/fcci/blob/HEAD/R/pois.R" class="external-link"><code>R/pois.R</code></a></small>
    <div class="hidden name"><code>confint_pois.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Build confidence intervals for the rate of a Poisson random variable using
the Feldman-Cousins construction (Feldman and Cousins, 1998).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">confint_pois</span><span class="op">(</span>
  <span class="va">n</span>,
  b <span class="op">=</span> <span class="fl">0</span>,
  cl <span class="op">=</span> <span class="fl">0.95</span>,
  acc <span class="op">=</span> <span class="fl">0.001</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">b</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,
  lambda_min <span class="op">=</span> <span class="cn">NULL</span>,
  lambda_max <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>number of events. Numeric vector of length one.</p></dd>
<dt>b</dt>
<dd><p>expected number of background events. Numeric vector of length one
or three (see Details).</p></dd>
<dt>cl</dt>
<dd><p>confidence level for the returned confidence interval.
A number between zero and one.</p></dd>
<dt>acc</dt>
<dd><p>required accuracy in the confidence interval endpoints.
A positive number.</p></dd>
<dt>lambda_min, lambda_max</dt>
<dd><p>window of Poisson rate
values for whom the Neyman belt construction is performed. Numeric vectors of
length one or <code>NULL</code> (see Details). For advanced users only, use the
default value (<code>NULL</code>) if unsure.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a numeric vector of length two, containing the confidence interval
endpoints.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The Feldman-Cousins confidence intervals construction
(Feldman and Cousins, 1998) provides a unified treatment for the estimation
of Poisson rates, which
produces consistent results for both the common case, where the number of
observed events <code>n</code> is greater than the number of background events
<code>b</code>, and the boundary cases, when <code>n</code> is equal or even less than
<code>b</code>. In these last cases, a naive treatment can lead to either
overcovering (that is, unnecessarily large confidence intervals;
this is the case for, <em>e.g.</em>, the intervals returned from
<code><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">stats::poisson.test</a></code> for zero events and no background) or,
even worse, undercovering and/or non-sensical confidence intervals
(relevant examples can be found in (Feldman and Cousins, 1998)).</p>
<p>In order to find confidence intervals, the standard Neyman construction
is performed over a grid of values for the estimated rate. The search
interval can be controlled through the parameters <code>lambda_min</code> and
<code>lambda_max</code>; if these are left as default (<code>NULL</code>), they are
estimated automatically based on a rough estimate, which should be adequate
in a large majority of cases.</p>
<p>The argument <code>b</code> controls the expected number of background events,
which would differ from zero if some of the event counts are expected
to correspond to spurious events. In other words, the number of total counts
<code>n</code> is assumed to follow a Poisson distribution with rate
<code>lambda + b</code>, with <code>b</code> known and <code>lambda</code> unknown and to be
estimated.</p>
<p>The original reference discusses a minor correction to confidence intervals,
which ensures that the produced upper limits are decreasing functions of
<code>b</code>.
This is computationally intensive and not necessary for the correctness of
Feldman-Cousins confidence intervals, but may facilitate interpretation for
e.g. sensitivity analyses.
The correction can be implemented by providing a length three numeric to the
<code>b</code> argument, such that <code>b[[1]]</code> is the expected background rate as
before, while <code>b[[2]]</code> and <code>b[[3]]</code> represent a maximum value
for <code>b</code> and a grid step. The construction is repeated over the whole
grid of <code>b</code> values and the actual upper limit is chosen as the
greatest upper limit encountered in the sequence of intervals so constructed.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Feldman, Gary J. and Cousins, Robert D.
"Unified approach to the classical statistical analysis of small signals"
<em>Phys. Rev. D</em> <strong>57</strong>, issue 7 (1998): 3873-3889.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">confint_pois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, cl <span class="op">=</span> <span class="fl">0.68</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  6.781298 13.804798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"cl")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.68</span>
<span class="r-in"><span class="fu">confint_pois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">5</span>, cl <span class="op">=</span> <span class="fl">0.68</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.899 8.805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"cl")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.68</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compare:</span></span>
<span class="r-in"><span class="fu">confint_pois</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0</span>, cl <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0000 3.0925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"cl")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-in"><span class="co"># with:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">poisson.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.000000 3.688879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"conf.level")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Valerio Gherardi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

