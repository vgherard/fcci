<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feldman-Cousins Confidence Intervals • fcci</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Feldman-Cousins Confidence Intervals">
<meta property="og:description" content="Provides support for building Feldman-Cousins confidence intervals [G. J. Feldman and R. D. Cousins (1998) &lt;doi:10.1103/PhysRevD.57.3873&gt;].">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fcci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vgherard/fcci/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="fcci">fcci<a class="anchor" aria-label="anchor" href="#fcci"></a>
</h1></div>
<!-- badges: start -->

<p><code>fcci</code> is an R package providing support for building <a href="https://doi.org/10.1103/PhysRevD.57.3873" class="external-link">Feldman-Cousins</a> confidence intervals.</p>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The Feldman-Cousins construction was originally developed in the context of High-Energy Physics, as a consistent method for building classical (frequentist) confidence intervals for Poisson rates of rare events. In experiments which expect only few events, it is often the case that the number of observed events is actually zero or, more generally, lower than the expected number of spurious background events (if the latter is significantly larger than zero).</p>
<p>In these situations, classical central intervals (such as those produced by <code><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">stats::poisson.test()</a></code>) are not satisfying, as they can lead both to significant overcoverage and to non-physical negative rates in the presence of a non-negligible background. Moreover, a naive special treatment of boundary values, which chooses to report an upper limit or a confidence interval depending on the data (the so-called <a href="https://doi.org/10.1103/PhysRevD.57.3873" class="external-link">“flip-flopping” policy</a>), can lead to undercoverage.</p>
<p>Feldman and Cousins provide a unified treatment of boundary and regular values, by explicitly constructing the <a href="https://en.wikipedia.org/wiki/Neyman_construction" class="external-link">Neyman confidence belt</a> for physical rates, using an ordering for count values based on a likelihood ratio.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest release of <code>fcci</code> from <a href="https://CRAN.R-project.org/package=fcci" class="external-link">CRAN</a> using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fcci"</span><span class="op">)</span></span></code></pre></div>
<p>and the development version from <a href="https://vgherard.r-universe.dev/" class="external-link">my R-universe</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fcci"</span>, repos <span class="op">=</span> <span class="st">"https://vgherard.r-universe.dev/"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vgherard/fcci" class="external-link">fcci</a></span><span class="op">)</span></span></code></pre></div>
<p>To compute a confidence interval for, e.g., a Poisson rate, use:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 95% C.L. interval for n = 10 events and b = 2 expected background events</span></span>
<span><span class="fu"><a href="reference/confint_pois.html">confint_pois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">2</span>, cl <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  2.9205 15.8130</span></span>
<span><span class="co">#&gt; attr(,"cl")</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
<p>Let us compare the 68% C.L. intervals for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n=0</annotation></semantics></math> events and no background obtained from <code>fcci</code> and from <code><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">stats::poisson.test()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/confint_pois.html">confint_pois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">0</span>, cl <span class="op">=</span> <span class="fl">0.68</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.000 1.275</span></span>
<span><span class="co">#&gt; attr(,"cl")</span></span>
<span><span class="co">#&gt; [1] 0.68</span></span>
<span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">poisson.test</a></span><span class="op">(</span><span class="fl">0</span>, conf.level <span class="op">=</span> <span class="fl">0.68</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span></span>
<span><span class="co">#&gt; [1] 0.000000 1.832581</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.68</span></span></code></pre></div>
<p>Notice that the latter is significantly larger, and it corresponds in fact to an 84% C.L. <em>upper limit</em> on the rate:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">poisson.test</a></span><span class="op">(</span><span class="fl">0</span>, conf.level <span class="op">=</span> <span class="fl">0.84</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span></span>
<span><span class="co">#&gt; [1] 0.000000 1.832581</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.84</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>For further help, you can consult the reference page of the <code>fcci</code> <a href="https://vgherard.github.io/fcci/">website</a> or <a href="https://github.com/vgherard/fcci/issues" class="external-link">open an issue</a> on the GitHub repository of <code>fcci</code>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fcci" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/vgherard/fcci/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/vgherard/fcci/issues" class="external-link">Report a bug</a></li>
<li><a href="https://journals.aps.org/prd/abstract/10.1103/PhysRevD.57.3873/" class="external-link">Feldman-Cousins original paper</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fcci</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Valerio Gherardi <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8215-3013" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Valerio Gherardi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
